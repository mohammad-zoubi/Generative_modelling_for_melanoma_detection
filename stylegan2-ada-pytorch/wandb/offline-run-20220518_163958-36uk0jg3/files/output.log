40000
20000
32000 8000
1000 500
Loaded pretrained weights for efficientnet-b2
Model efficientnet-b2 loaded.
8,405,995 total parameters.
8,405,995 training parameters.
Starts training...
Epoch: 1/30..  Training Loss: 0.087..  Training Accuracy: 0.966.. Validation Loss: 0.030..  Validation Accuracy: 0.991 Validation AUC Score: 1.000 Validation F1 Score: 0.991 Training Time: 0:03:08
Saving model in training_classifiers_events/test_all_melanoma/5_18/./classifier_efficientnet-b2_0.9912_2022-05-18 16:43:45.068868.pth
Epoch: 2/30..  Training Loss: 0.022..  Training Accuracy: 0.992.. Validation Loss: 0.065..  Validation Accuracy: 0.981 Validation AUC Score: 0.999 Validation F1 Score: 0.980 Training Time: 0:03:01
Epoch: 3/30..  Training Loss: 0.013..  Training Accuracy: 0.995.. Validation Loss: 0.021..  Validation Accuracy: 0.993 Validation AUC Score: 1.000 Validation F1 Score: 0.993 Training Time: 0:03:10
Saving model in training_classifiers_events/test_all_melanoma/5_18/./classifier_efficientnet-b2_0.9929_2022-05-18 16:49:57.408607.pth
Epoch: 4/30..  Training Loss: 0.011..  Training Accuracy: 0.997.. Validation Loss: 0.017..  Validation Accuracy: 0.994 Validation AUC Score: 1.000 Validation F1 Score: 0.994 Training Time: 0:03:01
Saving model in training_classifiers_events/test_all_melanoma/5_18/./classifier_efficientnet-b2_0.9938_2022-05-18 16:52:59.114596.pth
Epoch: 5/30..  Training Loss: 0.010..  Training Accuracy: 0.996.. Validation Loss: 0.229..  Validation Accuracy: 0.950 Validation AUC Score: 0.995 Validation F1 Score: 0.952 Training Time: 0:03:10
Traceback (most recent call last):
  File "melanoma_classifier.py", line 355, in <module>
    model_path = train(model, train_loader, validate_loader, epochs=args.epochs, es_patience=args.es)
  File "melanoma_classifier.py", line 86, in train
    output = model(images)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/ISIC256/project_scripts/GITHUB_REPO/Generative_modelling_for_melanoma_detection/stylegan2-ada-pytorch/utils.py", line 665, in forward
    features = self.arch(x)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/efficientnet_pytorch/model.py", line 314, in forward
    x = self.extract_features(inputs)
  File "/usr/local/lib/python3.8/dist-packages/efficientnet_pytorch/model.py", line 296, in extract_features
    x = block(x, drop_connect_rate=drop_connect_rate)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/efficientnet_pytorch/model.py", line 118, in forward
    x_squeezed = self._se_expand(x_squeezed)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/efficientnet_pytorch/utils.py", line 275, in forward
    x = F.conv2d(x, self.weight, self.bias, self.stride, self.padding, self.dilation, self.groups)
KeyboardInterrupt