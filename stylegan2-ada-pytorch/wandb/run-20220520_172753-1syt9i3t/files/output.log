20000
10000
label_0_idx_val 766 label_1_idx_val 766
label_0_idx_val 255 label_1_idx_val 255
Loaded pretrained weights for efficientnet-b2
Model efficientnet-b2 loaded.
8,405,995 total parameters.
8,405,995 training parameters.
Starts training...
Epoch: 1/15..  Training Loss: 0.107..  Training Accuracy: 0.960.. Validation Loss: 0.393..  Validation Accuracy: 0.877 Validation AUC Score: 0.946 Validation F1 Score: 0.870 Training Time: 0:01:28
Saving model in training_classifiers_events/test_all_melanoma/5_20/./classifier_efficientnet-b2_0.8773_2022-05-20 17:30:05.254861.pth
Epoch: 2/15..  Training Loss: 0.032..  Training Accuracy: 0.989.. Validation Loss: 0.412..  Validation Accuracy: 0.857 Validation AUC Score: 0.952 Validation F1 Score: 0.866 Training Time: 0:01:29
Epoch: 3/15..  Training Loss: 0.016..  Training Accuracy: 0.995.. Validation Loss: 0.559..  Validation Accuracy: 0.850 Validation AUC Score: 0.924 Validation F1 Score: 0.839 Training Time: 0:01:31
Epoch     3: reducing learning rate of group 0 to 1.0000e-04.
Epoch: 4/15..  Training Loss: 0.006..  Training Accuracy: 0.998.. Validation Loss: 0.405..  Validation Accuracy: 0.899 Validation AUC Score: 0.961 Validation F1 Score: 0.892 Training Time: 0:01:29
Saving model in training_classifiers_events/test_all_melanoma/5_20/./classifier_efficientnet-b2_0.8988_2022-05-20 17:34:35.410224.pth
Epoch: 5/15..  Training Loss: 0.002..  Training Accuracy: 0.999.. Validation Loss: 0.507..  Validation Accuracy: 0.896 Validation AUC Score: 0.964 Validation F1 Score: 0.888 Training Time: 0:01:28
Epoch: 6/15..  Training Loss: 0.001..  Training Accuracy: 1.000.. Validation Loss: 0.506..  Validation Accuracy: 0.895 Validation AUC Score: 0.958 Validation F1 Score: 0.889 Training Time: 0:01:28
Epoch     6: reducing learning rate of group 0 to 2.0000e-05.
Epoch: 7/15..  Training Loss: 0.001..  Training Accuracy: 1.000.. Validation Loss: 0.559..  Validation Accuracy: 0.891 Validation AUC Score: 0.958 Validation F1 Score: 0.882 Training Time: 0:01:28
Epoch: 8/15..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.567..  Validation Accuracy: 0.894 Validation AUC Score: 0.959 Validation F1 Score: 0.886 Training Time: 0:01:29
Epoch     8: reducing learning rate of group 0 to 4.0000e-06.
Epoch: 9/15..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.575..  Validation Accuracy: 0.892 Validation AUC Score: 0.958 Validation F1 Score: 0.884 Training Time: 0:01:28
Epoch: 10/15..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.587..  Validation Accuracy: 0.889 Validation AUC Score: 0.959 Validation F1 Score: 0.880 Training Time: 0:01:28
Epoch    10: reducing learning rate of group 0 to 8.0000e-07.
Early stopping. Best Val f1: 0.899
Total Training Time: 0:14:50
Test Accuracy: 0.89412, ROC_AUC_score: 0.96580, F1 score: 0.8875