20000
10000
                                              image_name  target
0      /ISIC256/synth60k/img_dir/imgs1/seed100001_mal...       1
1      /ISIC256/synth60k/img_dir/imgs1/seed100002_mal...       1
2      /ISIC256/synth60k/img_dir/imgs1/seed100003_mal...       1
3      /ISIC256/synth60k/img_dir/imgs1/seed100004_mal...       1
4      /ISIC256/synth60k/img_dir/imgs1/seed100005_mal...       1
...                                                  ...     ...
19995  /ISIC256/synth60k/img_dir_ben/imgs1/seed109996...       0
19996  /ISIC256/synth60k/img_dir_ben/imgs1/seed109997...       0
19997  /ISIC256/synth60k/img_dir_ben/imgs1/seed109998...       0
19998  /ISIC256/synth60k/img_dir_ben/imgs1/seed109999...       0
19999  /ISIC256/synth60k/img_dir_ben/imgs1/seed110000...       0
[20000 rows x 2 columns]
image_name_list 37648 gt_list 37648
30118
len(gt[gt==1]) 4085
train_list 0 gt 30118 37648
                                             image_name  target
0     /ISIC256/train_ISIC256_orig/imgs/ISIC_0000004.jpg       1
1     /ISIC256/train_ISIC256_orig/imgs/ISIC_0000013.jpg       1
2     /ISIC256/train_ISIC256_orig/imgs/ISIC_0000031_...       1
3     /ISIC256/train_ISIC256_orig/imgs/ISIC_0000036_...       1
4     /ISIC256/train_ISIC256_orig/imgs/ISIC_0000046_...       1
...                                                 ...     ...
2037  /ISIC256/train_ISIC256_orig/imgs/ISIC_0033415.jpg       0
2038  /ISIC256/train_ISIC256_orig/imgs/ISIC_0033416.jpg       0
2039  /ISIC256/train_ISIC256_orig/imgs/ISIC_0033424.jpg       0
2040  /ISIC256/train_ISIC256_orig/imgs/ISIC_0033426.jpg       0
2041  /ISIC256/train_ISIC256_orig/imgs/ISIC_0033429.jpg       0
[2042 rows x 2 columns]
[1 1 1 ... 1 1 1]
label_0_idx_val 766 label_1_idx_val 766
label_0_idx_val 255 label_1_idx_val 255
                                             image_name  target
0     /ISIC256/train_ISIC256_orig/val_set/ISIC_08094...       0
1     /ISIC256/train_ISIC256_orig/val_set/ISIC_41628...       0
2     /ISIC256/train_ISIC256_orig/val_set/ISIC_32822...       0
3     /ISIC256/train_ISIC256_orig/val_set/ISIC_08080...       0
4     /ISIC256/train_ISIC256_orig/val_set/ISIC_25326...       0
...                                                 ...     ...
1527  /ISIC256/train_ISIC256_orig/val_set/ISIC_89519...       1
1528  /ISIC256/train_ISIC256_orig/val_set/ISIC_00329...       1
1529  /ISIC256/train_ISIC256_orig/val_set/ISIC_00328...       1
1530  /ISIC256/train_ISIC256_orig/val_set/ISIC_00271...       1
1531  /ISIC256/train_ISIC256_orig/val_set/ISIC_00646...       1
[1532 rows x 2 columns]
                                             image_name  target
0     /ISIC256/train_ISIC256_orig/imgs/ISIC_0000004.jpg       1
1     /ISIC256/train_ISIC256_orig/imgs/ISIC_0000013.jpg       1
2     /ISIC256/train_ISIC256_orig/imgs/ISIC_0000031_...       1
3     /ISIC256/train_ISIC256_orig/imgs/ISIC_0000036_...       1
4     /ISIC256/train_ISIC256_orig/imgs/ISIC_0000046_...       1
...                                                 ...     ...
2037  /ISIC256/train_ISIC256_orig/imgs/ISIC_0033415.jpg       0
2038  /ISIC256/train_ISIC256_orig/imgs/ISIC_0033416.jpg       0
2039  /ISIC256/train_ISIC256_orig/imgs/ISIC_0033424.jpg       0
2040  /ISIC256/train_ISIC256_orig/imgs/ISIC_0033426.jpg       0
2041  /ISIC256/train_ISIC256_orig/imgs/ISIC_0033429.jpg       0
[2042 rows x 2 columns]
Loaded pretrained weights for efficientnet-b2
Model efficientnet-b2 loaded.
8,405,995 total parameters.
8,405,995 training parameters.
Starts training...
Epoch: 1/15..  Training Loss: 0.472..  Training Accuracy: 0.792.. Validation Loss: 5.914..  Validation Accuracy: 0.354 Validation AUC Score: 0.298 Validation F1 Score: 0.515 Training Time: 0:00:13
Saving model in training_classifiers_events/test_all_melanoma/5_21/./classifier_efficientnet-b2_0.3538_2022-05-21 18:49:32.639552.pth
Epoch: 2/15..  Training Loss: 0.300..  Training Accuracy: 0.876.. Validation Loss: 3.020..  Validation Accuracy: 0.364 Validation AUC Score: 0.297 Validation F1 Score: 0.525 Training Time: 0:00:13
Saving model in training_classifiers_events/test_all_melanoma/5_21/./classifier_efficientnet-b2_0.3636_2022-05-21 18:49:45.906171.pth
Epoch: 3/15..  Training Loss: 0.218..  Training Accuracy: 0.900.. Validation Loss: 3.501..  Validation Accuracy: 0.367 Validation AUC Score: 0.267 Validation F1 Score: 0.523 Training Time: 0:00:13
Saving model in training_classifiers_events/test_all_melanoma/5_21/./classifier_efficientnet-b2_0.3668_2022-05-21 18:49:59.401330.pth
Epoch: 4/15..  Training Loss: 0.158..  Training Accuracy: 0.948.. Validation Loss: 3.271..  Validation Accuracy: 0.395 Validation AUC Score: 0.427 Validation F1 Score: 0.530 Training Time: 0:00:13
Saving model in training_classifiers_events/test_all_melanoma/5_21/./classifier_efficientnet-b2_0.3949_2022-05-21 18:50:12.719401.pth
Epoch: 5/15..  Training Loss: 0.157..  Training Accuracy: 0.944.. Validation Loss: 4.359..  Validation Accuracy: 0.392 Validation AUC Score: 0.408 Validation F1 Score: 0.544 Training Time: 0:00:13
Epoch: 6/15..  Training Loss: 0.079..  Training Accuracy: 0.971.. Validation Loss: 8.381..  Validation Accuracy: 0.372 Validation AUC Score: 0.281 Validation F1 Score: 0.535 Training Time: 0:00:13
Epoch     6: reducing learning rate of group 0 to 1.0000e-04.
Epoch: 7/15..  Training Loss: 0.050..  Training Accuracy: 0.982.. Validation Loss: 7.635..  Validation Accuracy: 0.360 Validation AUC Score: 0.282 Validation F1 Score: 0.517 Training Time: 0:00:13
Epoch: 8/15..  Training Loss: 0.027..  Training Accuracy: 0.992.. Validation Loss: 7.293..  Validation Accuracy: 0.361 Validation AUC Score: 0.298 Validation F1 Score: 0.517 Training Time: 0:00:13
Epoch     8: reducing learning rate of group 0 to 2.0000e-05.
Epoch: 9/15..  Training Loss: 0.013..  Training Accuracy: 0.998.. Validation Loss: 7.176..  Validation Accuracy: 0.360 Validation AUC Score: 0.293 Validation F1 Score: 0.517 Training Time: 0:00:13
Epoch: 10/15..  Training Loss: 0.011..  Training Accuracy: 0.998.. Validation Loss: 7.206..  Validation Accuracy: 0.359 Validation AUC Score: 0.282 Validation F1 Score: 0.517 Training Time: 0:00:13
Epoch    10: reducing learning rate of group 0 to 4.0000e-06.
Early stopping. Best Val f1: 0.395
Total Training Time: 0:02:13
Test Accuracy: 0.39216, ROC_AUC_score: 0.45800, F1 score: 0.5345