20000
10000
                                              image_name  target
0      /ISIC256/synth60k/img_dir/imgs1/seed100001_mal...       1
1      /ISIC256/synth60k/img_dir/imgs1/seed100002_mal...       1
2      /ISIC256/synth60k/img_dir/imgs1/seed100003_mal...       1
3      /ISIC256/synth60k/img_dir/imgs1/seed100004_mal...       1
4      /ISIC256/synth60k/img_dir/imgs1/seed100005_mal...       1
...                                                  ...     ...
19995  /ISIC256/synth60k/img_dir_ben/imgs1/seed109996...       0
19996  /ISIC256/synth60k/img_dir_ben/imgs1/seed109997...       0
19997  /ISIC256/synth60k/img_dir_ben/imgs1/seed109998...       0
19998  /ISIC256/synth60k/img_dir_ben/imgs1/seed109999...       0
19999  /ISIC256/synth60k/img_dir_ben/imgs1/seed110000...       0
[20000 rows x 2 columns]
label_1s 4085 label_0s 26033
Downloading: "https://github.com/lukemelas/EfficientNet-PyTorch/releases/download/1.0/efficientnet-b2-8bb594d6.pth" to /home/moh/.cache/torch/hub/checkpoints/efficientnet-b2-8bb594d6.pth
len(input_images), len(gt) 20000 20000
                                              image_name  target
0      /ISIC256/train_ISIC256_orig/imgs/ISIC_0000002.jpg     1.0
1      /ISIC256/train_ISIC256_orig/imgs/ISIC_0000004.jpg     1.0
2      /ISIC256/train_ISIC256_orig/imgs/ISIC_0000013.jpg     1.0
3      /ISIC256/train_ISIC256_orig/imgs/ISIC_0000022_...     1.0
4      /ISIC256/train_ISIC256_orig/imgs/ISIC_0000026_...     1.0
...                                                  ...     ...
19995  /ISIC256/synth60k/img_dir/imgs1/seed105996_mal...     1.0
19996  /ISIC256/synth60k/img_dir/imgs1/seed105997_mal...     1.0
19997  /ISIC256/synth60k/img_dir/imgs1/seed105998_mal...     1.0
19998  /ISIC256/synth60k/img_dir/imgs1/seed105999_mal...     1.0
19999  /ISIC256/synth60k/img_dir/imgs1/seed106000_mal...     1.0
[20000 rows x 2 columns]
[1. 1. 1. ... 1. 1. 1.]
label_0_idx_val 766 label_1_idx_val 766
label_0_idx_val 255 label_1_idx_val 255
                                             image_name  target
0     /ISIC256/train_ISIC256_orig/val_set/ISIC_08094...       0
1     /ISIC256/train_ISIC256_orig/val_set/ISIC_41628...       0
2     /ISIC256/train_ISIC256_orig/val_set/ISIC_32822...       0
3     /ISIC256/train_ISIC256_orig/val_set/ISIC_08080...       0
4     /ISIC256/train_ISIC256_orig/val_set/ISIC_25326...       0
...                                                 ...     ...
1527  /ISIC256/train_ISIC256_orig/val_set/ISIC_89519...       1
1528  /ISIC256/train_ISIC256_orig/val_set/ISIC_00329...       1
1529  /ISIC256/train_ISIC256_orig/val_set/ISIC_00328...       1
1530  /ISIC256/train_ISIC256_orig/val_set/ISIC_00271...       1
1531  /ISIC256/train_ISIC256_orig/val_set/ISIC_00646...       1
[1532 rows x 2 columns]
                                              image_name  target
0      /ISIC256/train_ISIC256_orig/imgs/ISIC_0000002.jpg     1.0
1      /ISIC256/train_ISIC256_orig/imgs/ISIC_0000004.jpg     1.0
2      /ISIC256/train_ISIC256_orig/imgs/ISIC_0000013.jpg     1.0
3      /ISIC256/train_ISIC256_orig/imgs/ISIC_0000022_...     1.0
4      /ISIC256/train_ISIC256_orig/imgs/ISIC_0000026_...     1.0
...                                                  ...     ...
19995  /ISIC256/synth60k/img_dir/imgs1/seed105996_mal...     1.0
19996  /ISIC256/synth60k/img_dir/imgs1/seed105997_mal...     1.0
19997  /ISIC256/synth60k/img_dir/imgs1/seed105998_mal...     1.0
19998  /ISIC256/synth60k/img_dir/imgs1/seed105999_mal...     1.0
19999  /ISIC256/synth60k/img_dir/imgs1/seed106000_mal...     1.0
[20000 rows x 2 columns]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35.1M/35.1M [00:01<00:00, 30.5MB/s]
Loaded pretrained weights for efficientnet-b2
Model efficientnet-b2 loaded.
8,405,995 total parameters.
8,405,995 training parameters.
Starts training...
Epoch: 1/15..  Training Loss: 0.130..  Training Accuracy: 0.955.. Validation Loss: 0.198..  Validation Accuracy: 0.935 Validation AUC Score: 0.978 Validation F1 Score: 0.932 Training Time: 0:01:29
Saving model in training_classifiers_events/test_all_melanoma/5_22/./classifier_efficientnet-b2_0.9354_2022-05-22 11:31:49.332785.pth
Epoch: 2/15..  Training Loss: 0.086..  Training Accuracy: 0.971.. Validation Loss: 0.325..  Validation Accuracy: 0.928 Validation AUC Score: 0.969 Validation F1 Score: 0.925 Training Time: 0:01:29
Epoch: 3/15..  Training Loss: 0.068..  Training Accuracy: 0.977.. Validation Loss: 0.217..  Validation Accuracy: 0.933 Validation AUC Score: 0.980 Validation F1 Score: 0.931 Training Time: 0:01:29
Epoch     3: reducing learning rate of group 0 to 1.0000e-04.
Epoch: 4/15..  Training Loss: 0.031..  Training Accuracy: 0.989.. Validation Loss: 0.237..  Validation Accuracy: 0.947 Validation AUC Score: 0.986 Validation F1 Score: 0.945 Training Time: 0:01:31
Saving model in training_classifiers_events/test_all_melanoma/5_22/./classifier_efficientnet-b2_0.9471_2022-05-22 11:36:20.750329.pth
Epoch: 5/15..  Training Loss: 0.016..  Training Accuracy: 0.995.. Validation Loss: 0.287..  Validation Accuracy: 0.942 Validation AUC Score: 0.983 Validation F1 Score: 0.939 Training Time: 0:01:29
Epoch: 6/15..  Training Loss: 0.009..  Training Accuracy: 0.997.. Validation Loss: 0.311..  Validation Accuracy: 0.945 Validation AUC Score: 0.987 Validation F1 Score: 0.942 Training Time: 0:01:29
Epoch     6: reducing learning rate of group 0 to 2.0000e-05.
Epoch: 7/15..  Training Loss: 0.003..  Training Accuracy: 0.999.. Validation Loss: 0.343..  Validation Accuracy: 0.945 Validation AUC Score: 0.986 Validation F1 Score: 0.942 Training Time: 0:01:28
Epoch: 8/15..  Training Loss: 0.003..  Training Accuracy: 0.999.. Validation Loss: 0.360..  Validation Accuracy: 0.946 Validation AUC Score: 0.986 Validation F1 Score: 0.943 Training Time: 0:01:31
Epoch     8: reducing learning rate of group 0 to 4.0000e-06.
Epoch: 9/15..  Training Loss: 0.002..  Training Accuracy: 1.000.. Validation Loss: 0.369..  Validation Accuracy: 0.945 Validation AUC Score: 0.986 Validation F1 Score: 0.942 Training Time: 0:01:30
Epoch: 10/15..  Training Loss: 0.002..  Training Accuracy: 1.000.. Validation Loss: 0.369..  Validation Accuracy: 0.945 Validation AUC Score: 0.986 Validation F1 Score: 0.942 Training Time: 0:01:31
Epoch    10: reducing learning rate of group 0 to 8.0000e-07.
Early stopping. Best Val f1: 0.947
Total Training Time: 0:15:02
Test Accuracy: 0.93333, ROC_AUC_score: 0.98577, F1 score: 0.9300