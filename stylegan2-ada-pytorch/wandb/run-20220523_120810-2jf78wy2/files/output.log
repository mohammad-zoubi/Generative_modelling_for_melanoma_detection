20000
10000
                                              image_name  target
0      /ISIC256/synth60k/img_dir/imgs1/seed100001_mal...       1
1      /ISIC256/synth60k/img_dir/imgs1/seed100002_mal...       1
2      /ISIC256/synth60k/img_dir/imgs1/seed100003_mal...       1
3      /ISIC256/synth60k/img_dir/imgs1/seed100004_mal...       1
4      /ISIC256/synth60k/img_dir/imgs1/seed100005_mal...       1
...                                                  ...     ...
19995  /ISIC256/synth60k/img_dir_ben/imgs1/seed109996...       0
19996  /ISIC256/synth60k/img_dir_ben/imgs1/seed109997...       0
19997  /ISIC256/synth60k/img_dir_ben/imgs1/seed109998...       0
19998  /ISIC256/synth60k/img_dir_ben/imgs1/seed109999...       0
19999  /ISIC256/synth60k/img_dir_ben/imgs1/seed110000...       0
[20000 rows x 2 columns]
[1 1 1 ... 1 1 1]
label_0_idx_val 766 label_1_idx_val 766
label_0_idx_val 255 label_1_idx_val 255
                                             image_name  target
0     /ISIC256/train_ISIC256_orig/val_set/ISIC_08094...       0
1     /ISIC256/train_ISIC256_orig/val_set/ISIC_41628...       0
2     /ISIC256/train_ISIC256_orig/val_set/ISIC_32822...       0
3     /ISIC256/train_ISIC256_orig/val_set/ISIC_08080...       0
4     /ISIC256/train_ISIC256_orig/val_set/ISIC_25326...       0
...                                                 ...     ...
1527  /ISIC256/train_ISIC256_orig/val_set/ISIC_89519...       1
1528  /ISIC256/train_ISIC256_orig/val_set/ISIC_00329...       1
1529  /ISIC256/train_ISIC256_orig/val_set/ISIC_00328...       1
1530  /ISIC256/train_ISIC256_orig/val_set/ISIC_00271...       1
1531  /ISIC256/train_ISIC256_orig/val_set/ISIC_00646...       1
[1532 rows x 2 columns]
                                              image_name  target
0      /ISIC256/synth60k/img_dir/imgs1/seed100001_mal...       1
1      /ISIC256/synth60k/img_dir/imgs1/seed100002_mal...       1
2      /ISIC256/synth60k/img_dir/imgs1/seed100003_mal...       1
3      /ISIC256/synth60k/img_dir/imgs1/seed100004_mal...       1
4      /ISIC256/synth60k/img_dir/imgs1/seed100005_mal...       1
...                                                  ...     ...
19995  /ISIC256/synth60k/img_dir_ben/imgs1/seed109996...       0
19996  /ISIC256/synth60k/img_dir_ben/imgs1/seed109997...       0
19997  /ISIC256/synth60k/img_dir_ben/imgs1/seed109998...       0
19998  /ISIC256/synth60k/img_dir_ben/imgs1/seed109999...       0
19999  /ISIC256/synth60k/img_dir_ben/imgs1/seed110000...       0
[20000 rows x 2 columns]
Loaded pretrained weights for efficientnet-b2
Model efficientnet-b2 loaded.
8,405,995 total parameters.
8,405,995 training parameters.
Starts training...
Epoch: 1/20..  Training Loss: 0.107..  Training Accuracy: 0.960.. Validation Loss: 0.423..  Validation Accuracy: 0.879 Validation AUC Score: 0.941 Validation F1 Score: 0.878 Training Time: 0:01:17
Saving model in training_classifiers_events/test_all_melanoma/5_23/./classifier_efficientnet-b2_0.8786_2022-05-23 12:10:08.077831.pth
Epoch: 2/20..  Training Loss: 0.031..  Training Accuracy: 0.989.. Validation Loss: 0.736..  Validation Accuracy: 0.834 Validation AUC Score: 0.932 Validation F1 Score: 0.846 Training Time: 0:01:16
Epoch: 3/20..  Training Loss: 0.020..  Training Accuracy: 0.993.. Validation Loss: 0.804..  Validation Accuracy: 0.717 Validation AUC Score: 0.769 Validation F1 Score: 0.696 Training Time: 0:01:15
Epoch 00003: reducing learning rate of group 0 to 1.0000e-04.
Epoch: 4/20..  Training Loss: 0.005..  Training Accuracy: 0.998.. Validation Loss: 0.425..  Validation Accuracy: 0.885 Validation AUC Score: 0.949 Validation F1 Score: 0.879 Training Time: 0:01:16
Saving model in training_classifiers_events/test_all_melanoma/5_23/./classifier_efficientnet-b2_0.8851_2022-05-23 12:13:56.544022.pth
Epoch: 5/20..  Training Loss: 0.002..  Training Accuracy: 0.999.. Validation Loss: 0.456..  Validation Accuracy: 0.877 Validation AUC Score: 0.945 Validation F1 Score: 0.870 Training Time: 0:01:15
Epoch: 6/20..  Training Loss: 0.001..  Training Accuracy: 0.999.. Validation Loss: 0.493..  Validation Accuracy: 0.870 Validation AUC Score: 0.942 Validation F1 Score: 0.869 Training Time: 0:01:15
Epoch 00006: reducing learning rate of group 0 to 2.0000e-05.
Epoch: 7/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.491..  Validation Accuracy: 0.871 Validation AUC Score: 0.945 Validation F1 Score: 0.868 Training Time: 0:01:16
Epoch: 8/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.501..  Validation Accuracy: 0.873 Validation AUC Score: 0.945 Validation F1 Score: 0.870 Training Time: 0:01:15
Epoch 00008: reducing learning rate of group 0 to 4.0000e-06.
Epoch: 9/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.516..  Validation Accuracy: 0.877 Validation AUC Score: 0.945 Validation F1 Score: 0.873 Training Time: 0:01:15
Epoch: 10/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.521..  Validation Accuracy: 0.880 Validation AUC Score: 0.946 Validation F1 Score: 0.875 Training Time: 0:01:15
Epoch 00010: reducing learning rate of group 0 to 8.0000e-07.
Epoch: 11/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.525..  Validation Accuracy: 0.879 Validation AUC Score: 0.946 Validation F1 Score: 0.873 Training Time: 0:01:15
Epoch: 12/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.526..  Validation Accuracy: 0.879 Validation AUC Score: 0.946 Validation F1 Score: 0.873 Training Time: 0:01:15
Epoch 00012: reducing learning rate of group 0 to 1.6000e-07.
Epoch: 13/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.533..  Validation Accuracy: 0.879 Validation AUC Score: 0.946 Validation F1 Score: 0.874 Training Time: 0:01:16
Epoch: 14/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.529..  Validation Accuracy: 0.878 Validation AUC Score: 0.946 Validation F1 Score: 0.873 Training Time: 0:01:16
Epoch 00014: reducing learning rate of group 0 to 3.2000e-08.
Epoch: 15/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.524..  Validation Accuracy: 0.879 Validation AUC Score: 0.946 Validation F1 Score: 0.875 Training Time: 0:01:16
Epoch: 16/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.534..  Validation Accuracy: 0.879 Validation AUC Score: 0.946 Validation F1 Score: 0.873 Training Time: 0:01:16
Epoch 00016: reducing learning rate of group 0 to 6.4000e-09.
Epoch: 17/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.536..  Validation Accuracy: 0.879 Validation AUC Score: 0.946 Validation F1 Score: 0.874 Training Time: 0:01:15
Epoch: 18/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.524..  Validation Accuracy: 0.879 Validation AUC Score: 0.946 Validation F1 Score: 0.874 Training Time: 0:01:16
Traceback (most recent call last):
  File "melanoma_classifier.py", line 368, in <module>
    test_loader.to_csv('/ISIC256/test_loaders/test_1.csv')
AttributeError: 'DataLoader' object has no attribute 'to_csv'
Epoch: 19/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.530..  Validation Accuracy: 0.878 Validation AUC Score: 0.946 Validation F1 Score: 0.873 Training Time: 0:01:15
Early stopping. Best Val f1: 0.885
Total Training Time: 0:24:05