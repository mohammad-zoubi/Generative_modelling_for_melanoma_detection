
label_1s 4085 label_0s 26033
len(input_images), len(gt) 20000 20000
                                              image_name  target
0      /ISIC256/train_ISIC256_orig/imgs/ISIC_0000002.jpg     1.0
1      /ISIC256/train_ISIC256_orig/imgs/ISIC_0000004.jpg     1.0
2      /ISIC256/train_ISIC256_orig/imgs/ISIC_0000013.jpg     1.0
3      /ISIC256/train_ISIC256_orig/imgs/ISIC_0000022_...     1.0
4      /ISIC256/train_ISIC256_orig/imgs/ISIC_0000026_...     1.0
...                                                  ...     ...
19995  /ISIC256/synth60k/img_dir/imgs1/seed108996_mal...     1.0
19996  /ISIC256/synth60k/img_dir/imgs1/seed108997_mal...     1.0
19997  /ISIC256/synth60k/img_dir/imgs1/seed108998_mal...     1.0
19998  /ISIC256/synth60k/img_dir/imgs1/seed108999_mal...     1.0
19999  /ISIC256/synth60k/img_dir/imgs1/seed109000_mal...     1.0
[20000 rows x 2 columns]
[1. 1. 1. ... 1. 1. 1.]
label_0_idx_val 4881 label_1_idx_val 766
label_0_idx_val 1628 label_1_idx_val 255
                                             image_name  target
0     /ISIC256/train_ISIC256_orig/val_set/ISIC_04675...       0
1     /ISIC256/train_ISIC256_orig/val_set/ISIC_35982...       0
2     /ISIC256/train_ISIC256_orig/val_set/ISIC_62554...       0
3     /ISIC256/train_ISIC256_orig/val_set/ISIC_50112...       0
4     /ISIC256/train_ISIC256_orig/val_set/ISIC_16316...       0
...                                                 ...     ...
1878  /ISIC256/train_ISIC256_orig/val_set/ISIC_00587...       1
1879  /ISIC256/train_ISIC256_orig/val_set/ISIC_00716...       1
1880  /ISIC256/train_ISIC256_orig/val_set/ISIC_00721...       1
1881  /ISIC256/train_ISIC256_orig/val_set/ISIC_00652...       1
1882  /ISIC256/train_ISIC256_orig/val_set/ISIC_00564...       1
[1883 rows x 2 columns]
Loaded pretrained weights for efficientnet-b2
Model efficientnet-b2 loaded.
8,405,995 total parameters.
8,405,995 training parameters.
Starts training...
Epoch: 1/20..  Training Loss: 0.069..  Training Accuracy: 0.975.. Validation Loss: 0.137..  Validation Accuracy: 0.969 Validation AUC Score: 0.964 Validation F1 Score: 0.878 Training Time: 0:01:37
Saving model in training_classifiers_events/test_all_melanoma/5_26/./classifier_efficientnet-b2_0.9692_2022-05-26 19:31:05.335535.pth
Epoch: 2/20..  Training Loss: 0.032..  Training Accuracy: 0.989.. Validation Loss: 0.185..  Validation Accuracy: 0.964 Validation AUC Score: 0.953 Validation F1 Score: 0.863 Training Time: 0:01:36
Epoch: 3/20..  Training Loss: 0.021..  Training Accuracy: 0.992.. Validation Loss: 0.151..  Validation Accuracy: 0.967 Validation AUC Score: 0.970 Validation F1 Score: 0.872 Training Time: 0:01:36
Epoch     3: reducing learning rate of group 0 to 1.0000e-04.
Epoch: 4/20..  Training Loss: 0.007..  Training Accuracy: 0.998.. Validation Loss: 0.202..  Validation Accuracy: 0.974 Validation AUC Score: 0.976 Validation F1 Score: 0.898 Training Time: 0:01:36
Saving model in training_classifiers_events/test_all_melanoma/5_26/./classifier_efficientnet-b2_0.9743_2022-05-26 19:35:55.082354.pth
Epoch: 5/20..  Training Loss: 0.003..  Training Accuracy: 0.999.. Validation Loss: 0.232..  Validation Accuracy: 0.975 Validation AUC Score: 0.965 Validation F1 Score: 0.901 Training Time: 0:01:37
Saving model in training_classifiers_events/test_all_melanoma/5_26/./classifier_efficientnet-b2_0.9750_2022-05-26 19:37:32.471277.pth
Epoch: 6/20..  Training Loss: 0.002..  Training Accuracy: 0.999.. Validation Loss: 0.267..  Validation Accuracy: 0.976 Validation AUC Score: 0.963 Validation F1 Score: 0.903 Training Time: 0:01:36
Saving model in training_classifiers_events/test_all_melanoma/5_26/./classifier_efficientnet-b2_0.9756_2022-05-26 19:39:09.281629.pth
Epoch: 7/20..  Training Loss: 0.002..  Training Accuracy: 0.999.. Validation Loss: 0.278..  Validation Accuracy: 0.971 Validation AUC Score: 0.964 Validation F1 Score: 0.885 Training Time: 0:01:35
Epoch: 8/20..  Training Loss: 0.002..  Training Accuracy: 0.999.. Validation Loss: 0.303..  Validation Accuracy: 0.975 Validation AUC Score: 0.960 Validation F1 Score: 0.903 Training Time: 0:01:36
Epoch     8: reducing learning rate of group 0 to 2.0000e-05.
Epoch: 9/20..  Training Loss: 0.001..  Training Accuracy: 1.000.. Validation Loss: 0.307..  Validation Accuracy: 0.974 Validation AUC Score: 0.964 Validation F1 Score: 0.899 Training Time: 0:01:37
Epoch: 10/20..  Training Loss: 0.001..  Training Accuracy: 1.000.. Validation Loss: 0.328..  Validation Accuracy: 0.972 Validation AUC Score: 0.967 Validation F1 Score: 0.888 Training Time: 0:01:36
Epoch    10: reducing learning rate of group 0 to 4.0000e-06.
Epoch: 11/20..  Training Loss: 0.001..  Training Accuracy: 1.000.. Validation Loss: 0.321..  Validation Accuracy: 0.972 Validation AUC Score: 0.967 Validation F1 Score: 0.888 Training Time: 0:01:36
Epoch: 12/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.316..  Validation Accuracy: 0.974 Validation AUC Score: 0.966 Validation F1 Score: 0.896 Training Time: 0:01:36
Epoch    12: reducing learning rate of group 0 to 8.0000e-07.
Epoch: 13/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.310..  Validation Accuracy: 0.974 Validation AUC Score: 0.966 Validation F1 Score: 0.896 Training Time: 0:01:37
Epoch: 14/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.314..  Validation Accuracy: 0.974 Validation AUC Score: 0.967 Validation F1 Score: 0.899 Training Time: 0:01:35
Epoch    14: reducing learning rate of group 0 to 1.6000e-07.
Epoch: 15/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.306..  Validation Accuracy: 0.975 Validation AUC Score: 0.966 Validation F1 Score: 0.903 Training Time: 0:01:35
Epoch: 16/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.311..  Validation Accuracy: 0.974 Validation AUC Score: 0.966 Validation F1 Score: 0.898 Training Time: 0:01:36
Epoch    16: reducing learning rate of group 0 to 3.2000e-08.
Epoch: 17/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.309..  Validation Accuracy: 0.975 Validation AUC Score: 0.966 Validation F1 Score: 0.901 Training Time: 0:01:35
Epoch: 18/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.313..  Validation Accuracy: 0.974 Validation AUC Score: 0.967 Validation F1 Score: 0.899 Training Time: 0:01:36
Epoch    18: reducing learning rate of group 0 to 6.4000e-09.
Epoch: 19/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.308..  Validation Accuracy: 0.975 Validation AUC Score: 0.966 Validation F1 Score: 0.901 Training Time: 0:01:37
Epoch: 20/20..  Training Loss: 0.000..  Training Accuracy: 1.000.. Validation Loss: 0.311..  Validation Accuracy: 0.974 Validation AUC Score: 0.967 Validation F1 Score: 0.898 Training Time: 0:01:36
Total Training Time: 0:32:10
Test Accuracy: 0.97929, ROC_AUC_score: 0.95592, F1 score: 0.9179